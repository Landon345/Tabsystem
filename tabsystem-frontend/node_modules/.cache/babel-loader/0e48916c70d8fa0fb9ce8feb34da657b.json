{"ast":null,"code":"var _jsxFileName = \"/Users/landonschlangen/Documents/WebDevelopmentFolder/ReactApps/tabsystem/src/ProtectedAdminComponents/CommonItems/CreateCommonItem.jsx\";\nimport React, { useState, useEffect } from \"react\";\nimport { Link } from \"react-router-dom\";\nimport { useQuery, queryCache, useMutation } from \"react-query\";\nimport { GetCommonItems, PostCommonItem, DeleteCommonItem } from \"../../Api/CommonItems\";\nimport { GetCategories } from \"../../Api/Categories\";\nimport Navbar from \"../../Components/Navbar\"; //styled component imports\n\nimport { Box, Grid, Skeleton, Spinner, Input, Select } from \"@chakra-ui/core\";\nimport { MyButton, DeleteButton, CategoryAndCommonItemCard } from \"../../GlobalStyles/Styles\";\nexport default function CreateCommonItem() {\n  const [name, setName] = useState([]);\n  const [category, setCategory] = useState(null);\n  const [price, setPrice] = useState([]);\n  const [message, setMessage] = useState(\"\");\n  const {\n    status: status1,\n    data: commonitemsData\n  } = useQuery(\"GetCommonItems\", GetCommonItems, {});\n  const {\n    status: status2,\n    data: categoriesData\n  } = useQuery(\"GetCategories\", GetCategories, {});\n  const [mutate] = useMutation(PostCommonItem, {\n    onMutate: newCommonItem => {\n      // Cancel any outgoing refetches (so they don't overwrite our optimistic update)\n      queryCache.cancelQueries(\"GetCommonItems\"); // Snapshot the previous value\n\n      const previousCommonItems = queryCache.getQueryData(\"GetCommonItems\"); // Optimistically update to the new value\n\n      queryCache.setQueryData(\"GetCommmonItems\", old => [// ...old,\n      newCommonItem]); // Return the snapshotted value\n\n      return () => queryCache.setQueryData(\"GetCommmonItems\", previousCommonItems);\n    },\n    // If the mutation fails, use the value returned from onMutate to roll back\n    onError: (err, newCommonItem, rollback) => rollback(),\n    // Always refetch after error or success:\n    onSettled: () => {\n      queryCache.refetchQueries(\"GetCommonItems\");\n    }\n  });\n\n  const handleChange = event => {\n    if ([event.target.name] == \"name\") {\n      setName(event.target.value);\n    } else if ([event.target.name] == \"price\") {\n      setPrice(event.target.value);\n    } else if ([event.target.name] == \"category\") {\n      console.log(event.target.value);\n      setCategory(event.target.value);\n    }\n  };\n\n  const newCommonItem = async e => {\n    e.preventDefault();\n    const commonitem = {\n      name: name,\n      category_id: category,\n      price: price\n    };\n    const data = await mutate(commonitem);\n    setName(\"\");\n    setPrice(\"\");\n\n    if (data.success) {\n      setMessage(\"Successfully created item\");\n    } else {\n      setMessage(\"Something went wrong\");\n    }\n  };\n\n  const destroyCommonItem = async id => {\n    const data = await DeleteCommonItem(id);\n    queryCache.refetchQueries(\"GetCommonItems\");\n\n    if (data.success) {\n      setMessage(\"Successfully deleted item\");\n    } else {\n      setMessage(\"Something went wrong\");\n    }\n  }; //return this when loading\n\n\n  if (status1 === \"loading\" || status2 === \"loading\") {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: \"\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 100,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 101,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(Box, {\n      textAlign: \"center\",\n      fontSize: \"50px\",\n      mt: \"60px\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 102,\n        columnNumber: 11\n      }\n    }, \"Loading... \", /*#__PURE__*/React.createElement(Spinner, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 103,\n        columnNumber: 24\n      }\n    })), /*#__PURE__*/React.createElement(Skeleton, {\n      height: \"50px\",\n      my: \"10px\",\n      mx: \"10%\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 105,\n        columnNumber: 11\n      }\n    }), /*#__PURE__*/React.createElement(Skeleton, {\n      height: \"50px\",\n      my: \"10px\",\n      mx: \"10%\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 106,\n        columnNumber: 11\n      }\n    }), /*#__PURE__*/React.createElement(Skeleton, {\n      height: \"50px\",\n      my: \"10px\",\n      mx: \"10%\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 107,\n        columnNumber: 11\n      }\n    })));\n  } //return when error\n\n\n  if (status1 === \"error\" || status2 === \"error\") return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 114,\n      columnNumber: 12\n    }\n  }, \"error\");\n  return /*#__PURE__*/React.createElement(Box, {\n    bg: \"first300\",\n    minH: \"100vh\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 117,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(Navbar, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 118,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(Box, {\n    my: \"40px\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 119,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"form\", {\n    onSubmit: newCommonItem,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 120,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(Box, {\n    d: \"grid\",\n    gridTemplateColumns: \"1fr\",\n    mx: \"5%\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 121,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(Box, {\n    d: \"grid\",\n    gridTemplateColumns: \"1fr 2fr\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 122,\n      columnNumber: 13\n    }\n  }, \" \", /*#__PURE__*/React.createElement(Box, {\n    color: \"White\",\n    fontSize: \"30px\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 124,\n      columnNumber: 15\n    }\n  }, \"Name\"), /*#__PURE__*/React.createElement(Input, {\n    type: \"text\",\n    onChange: handleChange,\n    value: name,\n    name: \"name\",\n    width: \"200px\",\n    height: \"30px\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 127,\n      columnNumber: 15\n    }\n  })), /*#__PURE__*/React.createElement(Box, {\n    d: \"grid\",\n    gridTemplateColumns: \"1fr 2fr\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 136,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(Box, {\n    color: \"White\",\n    fontSize: \"30px\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 137,\n      columnNumber: 15\n    }\n  }, \"Price\"), /*#__PURE__*/React.createElement(Input, {\n    type: \"text\",\n    onChange: handleChange,\n    value: price,\n    name: \"price\",\n    width: \"200px\",\n    height: \"30px\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 140,\n      columnNumber: 15\n    }\n  })), /*#__PURE__*/React.createElement(Box, {\n    d: \"grid\",\n    gridTemplateColumns: \"1fr 2fr\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 150,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(Box, {\n    htmlFor: \"category\",\n    color: \"White\",\n    fontSize: \"30px\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 151,\n      columnNumber: 15\n    }\n  }, \"Category\"), /*#__PURE__*/React.createElement(Select, {\n    name: \"category\",\n    id: \"category\",\n    onChange: handleChange,\n    width: \"200px\",\n    height: \"30px\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 154,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(\"option\", {\n    value: null,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 161,\n      columnNumber: 17\n    }\n  }, \"none\"), categoriesData.map(category => /*#__PURE__*/React.createElement(\"option\", {\n    key: category.id,\n    value: category.id,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 163,\n      columnNumber: 19\n    }\n  }, category.name)))), /*#__PURE__*/React.createElement(Box, {\n    d: \"flex\",\n    justifyContent: \"center\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 169,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(MyButton, {\n    bg: \"White\",\n    bgh: \"second100\",\n    bcf: \"fifth200\",\n    color: \"first200\",\n    type: \"submit\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 170,\n      columnNumber: 15\n    }\n  }, \"Submit\"))))), /*#__PURE__*/React.createElement(Grid, {\n    templateColumns: \"repeat(auto-fit, minmax(200px, 1fr))\",\n    gap: 3,\n    mx: \"5%\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 183,\n      columnNumber: 7\n    }\n  }, commonitemsData.map((commonitem, index) => /*#__PURE__*/React.createElement(CategoryAndCommonItemCard, {\n    key: index,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 189,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(Box, {\n    color: \"white\",\n    textAlign: \"center\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 190,\n      columnNumber: 13\n    }\n  }, commonitem.name), /*#__PURE__*/React.createElement(Box, {\n    color: \"white\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 193,\n      columnNumber: 13\n    }\n  }, commonitem.price), /*#__PURE__*/React.createElement(DeleteButton, {\n    onClick: () => destroyCommonItem(commonitem.id),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 194,\n      columnNumber: 13\n    }\n  }, \"Delete\")))));\n}","map":{"version":3,"sources":["/Users/landonschlangen/Documents/WebDevelopmentFolder/ReactApps/tabsystem/src/ProtectedAdminComponents/CommonItems/CreateCommonItem.jsx"],"names":["React","useState","useEffect","Link","useQuery","queryCache","useMutation","GetCommonItems","PostCommonItem","DeleteCommonItem","GetCategories","Navbar","Box","Grid","Skeleton","Spinner","Input","Select","MyButton","DeleteButton","CategoryAndCommonItemCard","CreateCommonItem","name","setName","category","setCategory","price","setPrice","message","setMessage","status","status1","data","commonitemsData","status2","categoriesData","mutate","onMutate","newCommonItem","cancelQueries","previousCommonItems","getQueryData","setQueryData","old","onError","err","rollback","onSettled","refetchQueries","handleChange","event","target","value","console","log","e","preventDefault","commonitem","category_id","success","destroyCommonItem","id","map","index"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport { Link } from \"react-router-dom\";\nimport { useQuery, queryCache, useMutation } from \"react-query\";\nimport {\n  GetCommonItems,\n  PostCommonItem,\n  DeleteCommonItem,\n} from \"../../Api/CommonItems\";\nimport { GetCategories } from \"../../Api/Categories\";\nimport Navbar from \"../../Components/Navbar\";\n\n//styled component imports\nimport { Box, Grid, Skeleton, Spinner, Input, Select } from \"@chakra-ui/core\";\nimport {\n  MyButton,\n  DeleteButton,\n  CategoryAndCommonItemCard,\n} from \"../../GlobalStyles/Styles\";\n\nexport default function CreateCommonItem() {\n  const [name, setName] = useState([]);\n  const [category, setCategory] = useState(null);\n  const [price, setPrice] = useState([]);\n  const [message, setMessage] = useState(\"\");\n  const { status: status1, data: commonitemsData } = useQuery(\n    \"GetCommonItems\",\n    GetCommonItems,\n    {}\n  );\n  const { status: status2, data: categoriesData } = useQuery(\n    \"GetCategories\",\n    GetCategories,\n    {}\n  );\n\n  const [mutate] = useMutation(PostCommonItem, {\n    onMutate: (newCommonItem) => {\n      // Cancel any outgoing refetches (so they don't overwrite our optimistic update)\n      queryCache.cancelQueries(\"GetCommonItems\");\n\n      // Snapshot the previous value\n      const previousCommonItems = queryCache.getQueryData(\"GetCommonItems\");\n\n      // Optimistically update to the new value\n      queryCache.setQueryData(\"GetCommmonItems\", (old) => [\n        // ...old,\n        newCommonItem,\n      ]);\n\n      // Return the snapshotted value\n      return () =>\n        queryCache.setQueryData(\"GetCommmonItems\", previousCommonItems);\n    },\n    // If the mutation fails, use the value returned from onMutate to roll back\n    onError: (err, newCommonItem, rollback) => rollback(),\n    // Always refetch after error or success:\n    onSettled: () => {\n      queryCache.refetchQueries(\"GetCommonItems\");\n    },\n  });\n\n  const handleChange = (event) => {\n    if ([event.target.name] == \"name\") {\n      setName(event.target.value);\n    } else if ([event.target.name] == \"price\") {\n      setPrice(event.target.value);\n    } else if ([event.target.name] == \"category\") {\n      console.log(event.target.value);\n      setCategory(event.target.value);\n    }\n  };\n  const newCommonItem = async (e) => {\n    e.preventDefault();\n    const commonitem = {\n      name: name,\n      category_id: category,\n      price: price,\n    };\n    const data = await mutate(commonitem);\n    setName(\"\");\n    setPrice(\"\");\n    if (data.success) {\n      setMessage(\"Successfully created item\");\n    } else {\n      setMessage(\"Something went wrong\");\n    }\n  };\n  const destroyCommonItem = async (id) => {\n    const data = await DeleteCommonItem(id);\n    queryCache.refetchQueries(\"GetCommonItems\");\n    if (data.success) {\n      setMessage(\"Successfully deleted item\");\n    } else {\n      setMessage(\"Something went wrong\");\n    }\n  };\n  //return this when loading\n  if (status1 === \"loading\" || status2 === \"loading\") {\n    return (\n      <div className=\"\">\n        <div>\n          <Box textAlign=\"center\" fontSize=\"50px\" mt=\"60px\">\n            Loading... <Spinner />\n          </Box>\n          <Skeleton height=\"50px\" my=\"10px\" mx=\"10%\" />\n          <Skeleton height=\"50px\" my=\"10px\" mx=\"10%\" />\n          <Skeleton height=\"50px\" my=\"10px\" mx=\"10%\" />\n        </div>\n      </div>\n    );\n  }\n  //return when error\n  if (status1 === \"error\" || status2 === \"error\")\n    return <div className=\"\">error</div>;\n\n  return (\n    <Box bg=\"first300\" minH=\"100vh\">\n      <Navbar />\n      <Box my=\"40px\">\n        <form onSubmit={newCommonItem}>\n          <Box d=\"grid\" gridTemplateColumns=\"1fr\" mx=\"5%\">\n            <Box d=\"grid\" gridTemplateColumns=\"1fr 2fr\">\n              {\" \"}\n              <Box color=\"White\" fontSize=\"30px\">\n                Name\n              </Box>\n              <Input\n                type=\"text\"\n                onChange={handleChange}\n                value={name}\n                name=\"name\"\n                width=\"200px\"\n                height=\"30px\"\n              />\n            </Box>\n            <Box d=\"grid\" gridTemplateColumns=\"1fr 2fr\">\n              <Box color=\"White\" fontSize=\"30px\">\n                Price\n              </Box>\n              <Input\n                type=\"text\"\n                onChange={handleChange}\n                value={price}\n                name=\"price\"\n                width=\"200px\"\n                height=\"30px\"\n              />\n            </Box>\n\n            <Box d=\"grid\" gridTemplateColumns=\"1fr 2fr\">\n              <Box htmlFor=\"category\" color=\"White\" fontSize=\"30px\">\n                Category\n              </Box>\n              <Select\n                name=\"category\"\n                id=\"category\"\n                onChange={handleChange}\n                width=\"200px\"\n                height=\"30px\"\n              >\n                <option value={null}>none</option>\n                {categoriesData.map((category) => (\n                  <option key={category.id} value={category.id}>\n                    {category.name}\n                  </option>\n                ))}\n              </Select>\n            </Box>\n            <Box d=\"flex\" justifyContent=\"center\">\n              <MyButton\n                bg=\"White\"\n                bgh=\"second100\"\n                bcf=\"fifth200\"\n                color=\"first200\"\n                type=\"submit\"\n              >\n                Submit\n              </MyButton>\n            </Box>\n          </Box>\n        </form>\n      </Box>\n      <Grid\n        templateColumns=\"repeat(auto-fit, minmax(200px, 1fr))\"\n        gap={3}\n        mx=\"5%\"\n      >\n        {commonitemsData.map((commonitem, index) => (\n          <CategoryAndCommonItemCard key={index}>\n            <Box color=\"white\" textAlign=\"center\">\n              {commonitem.name}\n            </Box>\n            <Box color=\"white\">{commonitem.price}</Box>\n            <DeleteButton onClick={() => destroyCommonItem(commonitem.id)}>\n              Delete\n            </DeleteButton>\n          </CategoryAndCommonItemCard>\n        ))}\n      </Grid>\n    </Box>\n  );\n}\n"]},"metadata":{},"sourceType":"module"}