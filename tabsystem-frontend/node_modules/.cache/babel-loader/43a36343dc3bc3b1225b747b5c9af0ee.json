{"ast":null,"code":"import _objectWithoutPropertiesLoose from \"@babel/runtime/helpers/objectWithoutPropertiesLoose\";\nimport _extends from \"@babel/runtime/helpers/extends\";\n/** @jsx jsx */\n\nimport { jsx } from \"@emotion/core\";\nimport { useId } from \"@reach/auto-id\";\nimport { createContext, forwardRef, useContext, useEffect, useRef, useState } from \"react\";\nimport Box from \"../Box\";\nimport PseudoBox from \"../PseudoBox\";\nimport Text from \"../Text\";\nimport { useColorMode } from \"../ColorModeProvider\";\nimport usePrevious from \"../usePrevious\";\nimport { getFocusables, useForkRef, wrapEvent } from \"../utils\";\nimport { useMenuItemStyle, useMenuListStyle } from \"./styles\";\nimport Divider from \"../Divider\";\nimport Popper from \"../Popper\";\nvar MenuContext = createContext();\n\nvar Menu = function Menu(_ref) {\n  var children = _ref.children,\n      isOpenProp = _ref.isOpen,\n      defaultIsOpen = _ref.defaultIsOpen,\n      onOpen = _ref.onOpen,\n      onClose = _ref.onClose,\n      _ref$autoSelect = _ref.autoSelect,\n      autoSelect = _ref$autoSelect === void 0 ? true : _ref$autoSelect,\n      _ref$closeOnBlur = _ref.closeOnBlur,\n      closeOnBlur = _ref$closeOnBlur === void 0 ? true : _ref$closeOnBlur,\n      _ref$closeOnSelect = _ref.closeOnSelect,\n      closeOnSelect = _ref$closeOnSelect === void 0 ? true : _ref$closeOnSelect,\n      defaultActiveIndex = _ref.defaultActiveIndex,\n      placement = _ref.placement;\n\n  var _useColorMode = useColorMode(),\n      colorMode = _useColorMode.colorMode;\n\n  var _useState = useState(defaultActiveIndex || -1),\n      activeIndex = _useState[0],\n      setActiveIndex = _useState[1];\n\n  var _useState2 = useState(defaultIsOpen || false),\n      isOpen = _useState2[0],\n      setIsOpen = _useState2[1];\n\n  var _useRef = useRef(isOpenProp != null),\n      isControlled = _useRef.current;\n\n  var _isOpen = isControlled ? isOpenProp : isOpen;\n\n  var menuId = \"menu-\" + useId();\n  var buttonId = \"menubutton-\" + useId();\n  var focusableItems = useRef(null);\n  var menuRef = useRef(null);\n  var buttonRef = useRef(null);\n  useEffect(function () {\n    if (_isOpen && menuRef && menuRef.current) {\n      var focusables = getFocusables(menuRef.current).filter(function (node) {\n        return [\"menuitem\", \"menuitemradio\", \"menuitemcheckbox\"].includes(node.getAttribute(\"role\"));\n      });\n      focusableItems.current = menuRef.current ? focusables : [];\n      initTabIndex();\n    }\n  }, [_isOpen]);\n\n  var updateTabIndex = function updateTabIndex(index) {\n    if (focusableItems.current.length > 0) {\n      var nodeAtIndex = focusableItems.current[index];\n      focusableItems.current.forEach(function (node) {\n        if (node !== nodeAtIndex) {\n          node.setAttribute(\"tabindex\", -1);\n        }\n      });\n      nodeAtIndex.setAttribute(\"tabindex\", 0);\n    }\n  };\n\n  var resetTabIndex = function resetTabIndex() {\n    if (focusableItems.current) {\n      focusableItems.current.forEach(function (node) {\n        return node.setAttribute(\"tabindex\", -1);\n      });\n    }\n  };\n\n  var initTabIndex = function initTabIndex() {\n    focusableItems.current.forEach(function (node, index) {\n      return index === 0 && node.setAttribute(\"tabindex\", 0);\n    });\n  };\n\n  var wasPreviouslyOpen = usePrevious(_isOpen);\n  useEffect(function () {\n    if (activeIndex !== -1) {\n      focusableItems.current[activeIndex] && focusableItems.current[activeIndex].focus();\n      updateTabIndex(activeIndex);\n    }\n\n    if (activeIndex === -1 && !_isOpen && wasPreviouslyOpen) {\n      buttonRef.current && buttonRef.current.focus();\n    }\n\n    if (activeIndex === -1 && _isOpen) {\n      menuRef.current && menuRef.current.focus();\n    }\n  }, [activeIndex, _isOpen, buttonRef, menuRef, wasPreviouslyOpen]);\n\n  var focusOnFirstItem = function focusOnFirstItem() {\n    openMenu();\n    setActiveIndex(0);\n  };\n\n  var openMenu = function openMenu() {\n    if (!isControlled) {\n      setIsOpen(true);\n    }\n\n    if (onOpen) {\n      onOpen();\n    }\n  };\n\n  var focusAtIndex = function focusAtIndex(index) {\n    setActiveIndex(index);\n  };\n\n  var focusOnLastItem = function focusOnLastItem() {\n    openMenu();\n    setActiveIndex(focusableItems.current.length - 1);\n  };\n\n  var closeMenu = function closeMenu() {\n    if (!isControlled) {\n      setIsOpen(false);\n    }\n\n    if (onClose) {\n      onClose();\n    }\n\n    setActiveIndex(-1);\n    resetTabIndex();\n  };\n\n  var context = {\n    activeIndex: activeIndex,\n    isOpen: _isOpen,\n    focusAtIndex: focusAtIndex,\n    focusOnLastItem: focusOnLastItem,\n    focusOnFirstItem: focusOnFirstItem,\n    closeMenu: closeMenu,\n    buttonRef: buttonRef,\n    menuRef: menuRef,\n    focusableItems: focusableItems,\n    placement: placement,\n    menuId: menuId,\n    buttonId: buttonId,\n    openMenu: openMenu,\n    autoSelect: autoSelect,\n    closeOnSelect: closeOnSelect,\n    closeOnBlur: closeOnBlur,\n    colorMode: colorMode\n  };\n  return jsx(MenuContext.Provider, {\n    value: context\n  }, typeof children === \"function\" ? children({\n    isOpen: _isOpen,\n    onClose: closeMenu\n  }) : children);\n};\n\nexport function useMenuContext() {\n  var context = useContext(MenuContext);\n\n  if (context === undefined) {\n    throw new Error(\"useMenuContext must be used within a MenuContext Provider\");\n  }\n\n  return context;\n} //////////////////////////////////////////////////////////////////////////////////////////\n\nvar PseudoButton = forwardRef(function (props, ref) {\n  return jsx(PseudoBox, _extends({\n    ref: ref,\n    as: \"button\"\n  }, props));\n});\nPseudoButton.displayName = \"PseudoButton\";\nvar MenuButton = forwardRef(function (_ref2, ref) {\n  var onClick = _ref2.onClick,\n      onKeyDown = _ref2.onKeyDown,\n      _ref2$as = _ref2.as,\n      Comp = _ref2$as === void 0 ? PseudoButton : _ref2$as,\n      rest = _objectWithoutPropertiesLoose(_ref2, [\"onClick\", \"onKeyDown\", \"as\"]);\n\n  var _useMenuContext = useMenuContext(),\n      isOpen = _useMenuContext.isOpen,\n      focusOnLastItem = _useMenuContext.focusOnLastItem,\n      focusOnFirstItem = _useMenuContext.focusOnFirstItem,\n      closeMenu = _useMenuContext.closeMenu,\n      menuId = _useMenuContext.menuId,\n      buttonId = _useMenuContext.buttonId,\n      autoSelect = _useMenuContext.autoSelect,\n      openMenu = _useMenuContext.openMenu,\n      buttonRef = _useMenuContext.buttonRef;\n\n  var menuButtonRef = useForkRef(buttonRef, ref);\n  return jsx(Comp, _extends({\n    \"aria-haspopup\": \"menu\",\n    \"aria-expanded\": isOpen,\n    \"aria-controls\": menuId,\n    id: buttonId,\n    role: \"button\",\n    ref: menuButtonRef,\n    onClick: wrapEvent(onClick, function () {\n      if (isOpen) {\n        closeMenu();\n      } else {\n        if (autoSelect) {\n          focusOnFirstItem();\n        } else {\n          openMenu();\n        }\n      }\n    }),\n    onKeyDown: wrapEvent(onKeyDown, function (event) {\n      if (event.key === \"ArrowDown\") {\n        event.preventDefault();\n        focusOnFirstItem();\n      }\n\n      if (event.key === \"ArrowUp\") {\n        event.preventDefault();\n        focusOnLastItem();\n      }\n    })\n  }, rest));\n});\nMenuButton.displayName = \"MenuButton\"; //////////////////////////////////////////////////////////////////////////////////////////\n\nvar MenuList = function MenuList(_ref3) {\n  var onKeyDown = _ref3.onKeyDown,\n      onBlur = _ref3.onBlur,\n      props = _objectWithoutPropertiesLoose(_ref3, [\"onKeyDown\", \"onBlur\"]);\n\n  var _useMenuContext2 = useMenuContext(),\n      index = _useMenuContext2.activeIndex,\n      isOpen = _useMenuContext2.isOpen,\n      focusAtIndex = _useMenuContext2.focusAtIndex,\n      focusOnFirstItem = _useMenuContext2.focusOnFirstItem,\n      focusOnLastItem = _useMenuContext2.focusOnLastItem,\n      closeMenu = _useMenuContext2.closeMenu,\n      focusableItems = _useMenuContext2.focusableItems,\n      buttonRef = _useMenuContext2.buttonRef,\n      menuId = _useMenuContext2.menuId,\n      buttonId = _useMenuContext2.buttonId,\n      menuRef = _useMenuContext2.menuRef,\n      closeOnBlur = _useMenuContext2.closeOnBlur,\n      placement = _useMenuContext2.placement;\n\n  var handleKeyDown = function handleKeyDown(event) {\n    var count = focusableItems.current.length;\n    var nextIndex;\n\n    if (event.key === \"ArrowDown\") {\n      event.preventDefault();\n      nextIndex = (index + 1) % count;\n      focusAtIndex(nextIndex);\n    } else if (event.key === \"ArrowUp\") {\n      event.preventDefault();\n      nextIndex = (index - 1 + count) % count;\n      focusAtIndex(nextIndex);\n    } else if (event.key === \"Home\") {\n      focusOnFirstItem();\n    } else if (event.key === \"End\") {\n      focusOnLastItem();\n    } else if (event.key === \"Tab\") {\n      event.preventDefault();\n    } else if (event.key === \"Escape\") {\n      closeMenu();\n    } // Set focus based on first character\n\n\n    if (/^[a-z0-9_-]$/i.test(event.key)) {\n      event.stopPropagation();\n      event.preventDefault();\n      var foundNode = focusableItems.current.find(function (item) {\n        return item.textContent.toLowerCase().startsWith(event.key);\n      });\n\n      if (foundNode) {\n        nextIndex = focusableItems.current.indexOf(foundNode);\n        focusAtIndex(nextIndex);\n      }\n    }\n\n    onKeyDown && onKeyDown(event);\n  }; // Close the menu on blur\n\n\n  var handleBlur = function handleBlur(event) {\n    if (closeOnBlur && isOpen && menuRef.current && buttonRef.current && !menuRef.current.contains(event.relatedTarget) && !buttonRef.current.contains(event.relatedTarget)) {\n      closeMenu();\n    }\n\n    onBlur && onBlur(event);\n  };\n\n  var styleProps = useMenuListStyle();\n  return jsx(Popper, _extends({\n    usePortal: false,\n    isOpen: isOpen,\n    anchorEl: buttonRef.current,\n    placement: placement,\n    modifiers: {\n      preventOverflow: {\n        enabled: true,\n        boundariesElement: \"viewport\"\n      }\n    },\n    minW: \"3xs\",\n    rounded: \"md\",\n    role: \"menu\",\n    ref: menuRef,\n    id: menuId,\n    py: 2,\n    \"aria-labelledby\": buttonId,\n    onKeyDown: handleKeyDown,\n    onBlur: handleBlur,\n    tabIndex: -1,\n    zIndex: \"1\",\n    _focus: {\n      outline: 0\n    }\n  }, styleProps, props));\n}; //////////////////////////////////////////////////////////////////////////////////////////\n\n\nvar MenuItem = forwardRef(function (_ref4, ref) {\n  var isDisabled = _ref4.isDisabled,\n      onClick = _ref4.onClick,\n      onMouseLeave = _ref4.onMouseLeave,\n      onMouseEnter = _ref4.onMouseEnter,\n      onKeyDown = _ref4.onKeyDown,\n      _ref4$role = _ref4.role,\n      role = _ref4$role === void 0 ? \"menuitem\" : _ref4$role,\n      props = _objectWithoutPropertiesLoose(_ref4, [\"isDisabled\", \"onClick\", \"onMouseLeave\", \"onMouseEnter\", \"onKeyDown\", \"role\"]);\n\n  var _useMenuContext3 = useMenuContext(),\n      focusableItems = _useMenuContext3.focusableItems,\n      focusAtIndex = _useMenuContext3.focusAtIndex,\n      closeOnSelect = _useMenuContext3.closeOnSelect,\n      closeMenu = _useMenuContext3.closeMenu;\n\n  var styleProps = useMenuItemStyle();\n  return jsx(PseudoBox, _extends({\n    as: \"button\",\n    ref: ref,\n    display: \"flex\",\n    textDecoration: \"none\",\n    color: \"inherit\",\n    minHeight: \"32px\",\n    alignItems: \"center\",\n    textAlign: \"left\",\n    outline: \"none\",\n    px: 4,\n    role: role,\n    tabIndex: -1,\n    disabled: isDisabled,\n    \"aria-disabled\": isDisabled,\n    onClick: wrapEvent(onClick, function (event) {\n      if (isDisabled) {\n        event.stopPropagation();\n        event.preventDefault();\n        return;\n      }\n\n      if (closeOnSelect) {\n        closeMenu();\n      }\n    }),\n    onMouseEnter: wrapEvent(onMouseEnter, function (event) {\n      if (isDisabled) {\n        event.stopPropagation();\n        event.preventDefault();\n        return;\n      }\n\n      if (focusableItems && focusableItems.current.length > 0) {\n        var nextIndex = focusableItems.current.indexOf(event.currentTarget);\n        focusAtIndex(nextIndex);\n      }\n    }),\n    onMouseLeave: wrapEvent(onMouseLeave, function () {\n      focusAtIndex(-1);\n    }),\n    onKeyDown: wrapEvent(onKeyDown, function (event) {\n      if (isDisabled) return;\n\n      if (event.key === \"Enter\" || event.key === \" \") {\n        event.preventDefault();\n\n        if (onClick) {\n          onClick();\n        }\n\n        if (closeOnSelect) {\n          closeMenu();\n        }\n      }\n    })\n  }, styleProps, props));\n});\nMenuItem.displayName = \"MenuItem\"; //////////////////////////////////////////////////////////////////////////////////////////\n\nvar MenuDivider = forwardRef(function (props, ref) {\n  return jsx(Divider, _extends({\n    ref: ref,\n    orientation: \"horizontal\"\n  }, props));\n});\nMenuDivider.displayName = \"MenuDivider\"; //////////////////////////////////////////////////////////////////////////////////////////\n\nvar MenuGroup = forwardRef(function (_ref5, ref) {\n  var children = _ref5.children,\n      title = _ref5.title,\n      rest = _objectWithoutPropertiesLoose(_ref5, [\"children\", \"title\"]);\n\n  return jsx(Box, {\n    ref: ref,\n    role: \"group\"\n  }, title && jsx(Text, _extends({\n    mx: 4,\n    my: 2,\n    fontWeight: \"semibold\",\n    fontSize: \"sm\"\n  }, rest), title), children);\n});\nMenuGroup.displayName = \"MenuGroup\"; //////////////////////////////////////////////////////////////////////////////////////////\n\nexport default Menu;\nexport { MenuButton, MenuDivider, MenuGroup, MenuList, MenuItem };\nexport * from \"./MenuOption\";","map":{"version":3,"sources":["/Users/landonschlangen/Documents/WebDevelopmentFolder/ReactApps/tabsystem/node_modules/@chakra-ui/core/dist/es/Menu/index.js"],"names":["_objectWithoutPropertiesLoose","_extends","jsx","useId","createContext","forwardRef","useContext","useEffect","useRef","useState","Box","PseudoBox","Text","useColorMode","usePrevious","getFocusables","useForkRef","wrapEvent","useMenuItemStyle","useMenuListStyle","Divider","Popper","MenuContext","Menu","_ref","children","isOpenProp","isOpen","defaultIsOpen","onOpen","onClose","_ref$autoSelect","autoSelect","_ref$closeOnBlur","closeOnBlur","_ref$closeOnSelect","closeOnSelect","defaultActiveIndex","placement","_useColorMode","colorMode","_useState","activeIndex","setActiveIndex","_useState2","setIsOpen","_useRef","isControlled","current","_isOpen","menuId","buttonId","focusableItems","menuRef","buttonRef","focusables","filter","node","includes","getAttribute","initTabIndex","updateTabIndex","index","length","nodeAtIndex","forEach","setAttribute","resetTabIndex","wasPreviouslyOpen","focus","focusOnFirstItem","openMenu","focusAtIndex","focusOnLastItem","closeMenu","context","Provider","value","useMenuContext","undefined","Error","PseudoButton","props","ref","as","displayName","MenuButton","_ref2","onClick","onKeyDown","_ref2$as","Comp","rest","_useMenuContext","menuButtonRef","id","role","event","key","preventDefault","MenuList","_ref3","onBlur","_useMenuContext2","handleKeyDown","count","nextIndex","test","stopPropagation","foundNode","find","item","textContent","toLowerCase","startsWith","indexOf","handleBlur","contains","relatedTarget","styleProps","usePortal","anchorEl","modifiers","preventOverflow","enabled","boundariesElement","minW","rounded","py","tabIndex","zIndex","_focus","outline","MenuItem","_ref4","isDisabled","onMouseLeave","onMouseEnter","_ref4$role","_useMenuContext3","display","textDecoration","color","minHeight","alignItems","textAlign","px","disabled","currentTarget","MenuDivider","orientation","MenuGroup","_ref5","title","mx","my","fontWeight","fontSize"],"mappings":"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","sourcesContent":["import _objectWithoutPropertiesLoose from \"@babel/runtime/helpers/objectWithoutPropertiesLoose\";\nimport _extends from \"@babel/runtime/helpers/extends\";\n\n/** @jsx jsx */\nimport { jsx } from \"@emotion/core\";\nimport { useId } from \"@reach/auto-id\";\nimport { createContext, forwardRef, useContext, useEffect, useRef, useState } from \"react\";\nimport Box from \"../Box\";\nimport PseudoBox from \"../PseudoBox\";\nimport Text from \"../Text\";\nimport { useColorMode } from \"../ColorModeProvider\";\nimport usePrevious from \"../usePrevious\";\nimport { getFocusables, useForkRef, wrapEvent } from \"../utils\";\nimport { useMenuItemStyle, useMenuListStyle } from \"./styles\";\nimport Divider from \"../Divider\";\nimport Popper from \"../Popper\";\nvar MenuContext = createContext();\n\nvar Menu = function Menu(_ref) {\n  var children = _ref.children,\n      isOpenProp = _ref.isOpen,\n      defaultIsOpen = _ref.defaultIsOpen,\n      onOpen = _ref.onOpen,\n      onClose = _ref.onClose,\n      _ref$autoSelect = _ref.autoSelect,\n      autoSelect = _ref$autoSelect === void 0 ? true : _ref$autoSelect,\n      _ref$closeOnBlur = _ref.closeOnBlur,\n      closeOnBlur = _ref$closeOnBlur === void 0 ? true : _ref$closeOnBlur,\n      _ref$closeOnSelect = _ref.closeOnSelect,\n      closeOnSelect = _ref$closeOnSelect === void 0 ? true : _ref$closeOnSelect,\n      defaultActiveIndex = _ref.defaultActiveIndex,\n      placement = _ref.placement;\n\n  var _useColorMode = useColorMode(),\n      colorMode = _useColorMode.colorMode;\n\n  var _useState = useState(defaultActiveIndex || -1),\n      activeIndex = _useState[0],\n      setActiveIndex = _useState[1];\n\n  var _useState2 = useState(defaultIsOpen || false),\n      isOpen = _useState2[0],\n      setIsOpen = _useState2[1];\n\n  var _useRef = useRef(isOpenProp != null),\n      isControlled = _useRef.current;\n\n  var _isOpen = isControlled ? isOpenProp : isOpen;\n\n  var menuId = \"menu-\" + useId();\n  var buttonId = \"menubutton-\" + useId();\n  var focusableItems = useRef(null);\n  var menuRef = useRef(null);\n  var buttonRef = useRef(null);\n  useEffect(function () {\n    if (_isOpen && menuRef && menuRef.current) {\n      var focusables = getFocusables(menuRef.current).filter(function (node) {\n        return [\"menuitem\", \"menuitemradio\", \"menuitemcheckbox\"].includes(node.getAttribute(\"role\"));\n      });\n      focusableItems.current = menuRef.current ? focusables : [];\n      initTabIndex();\n    }\n  }, [_isOpen]);\n\n  var updateTabIndex = function updateTabIndex(index) {\n    if (focusableItems.current.length > 0) {\n      var nodeAtIndex = focusableItems.current[index];\n      focusableItems.current.forEach(function (node) {\n        if (node !== nodeAtIndex) {\n          node.setAttribute(\"tabindex\", -1);\n        }\n      });\n      nodeAtIndex.setAttribute(\"tabindex\", 0);\n    }\n  };\n\n  var resetTabIndex = function resetTabIndex() {\n    if (focusableItems.current) {\n      focusableItems.current.forEach(function (node) {\n        return node.setAttribute(\"tabindex\", -1);\n      });\n    }\n  };\n\n  var initTabIndex = function initTabIndex() {\n    focusableItems.current.forEach(function (node, index) {\n      return index === 0 && node.setAttribute(\"tabindex\", 0);\n    });\n  };\n\n  var wasPreviouslyOpen = usePrevious(_isOpen);\n  useEffect(function () {\n    if (activeIndex !== -1) {\n      focusableItems.current[activeIndex] && focusableItems.current[activeIndex].focus();\n      updateTabIndex(activeIndex);\n    }\n\n    if (activeIndex === -1 && !_isOpen && wasPreviouslyOpen) {\n      buttonRef.current && buttonRef.current.focus();\n    }\n\n    if (activeIndex === -1 && _isOpen) {\n      menuRef.current && menuRef.current.focus();\n    }\n  }, [activeIndex, _isOpen, buttonRef, menuRef, wasPreviouslyOpen]);\n\n  var focusOnFirstItem = function focusOnFirstItem() {\n    openMenu();\n    setActiveIndex(0);\n  };\n\n  var openMenu = function openMenu() {\n    if (!isControlled) {\n      setIsOpen(true);\n    }\n\n    if (onOpen) {\n      onOpen();\n    }\n  };\n\n  var focusAtIndex = function focusAtIndex(index) {\n    setActiveIndex(index);\n  };\n\n  var focusOnLastItem = function focusOnLastItem() {\n    openMenu();\n    setActiveIndex(focusableItems.current.length - 1);\n  };\n\n  var closeMenu = function closeMenu() {\n    if (!isControlled) {\n      setIsOpen(false);\n    }\n\n    if (onClose) {\n      onClose();\n    }\n\n    setActiveIndex(-1);\n    resetTabIndex();\n  };\n\n  var context = {\n    activeIndex: activeIndex,\n    isOpen: _isOpen,\n    focusAtIndex: focusAtIndex,\n    focusOnLastItem: focusOnLastItem,\n    focusOnFirstItem: focusOnFirstItem,\n    closeMenu: closeMenu,\n    buttonRef: buttonRef,\n    menuRef: menuRef,\n    focusableItems: focusableItems,\n    placement: placement,\n    menuId: menuId,\n    buttonId: buttonId,\n    openMenu: openMenu,\n    autoSelect: autoSelect,\n    closeOnSelect: closeOnSelect,\n    closeOnBlur: closeOnBlur,\n    colorMode: colorMode\n  };\n  return jsx(MenuContext.Provider, {\n    value: context\n  }, typeof children === \"function\" ? children({\n    isOpen: _isOpen,\n    onClose: closeMenu\n  }) : children);\n};\n\nexport function useMenuContext() {\n  var context = useContext(MenuContext);\n\n  if (context === undefined) {\n    throw new Error(\"useMenuContext must be used within a MenuContext Provider\");\n  }\n\n  return context;\n} //////////////////////////////////////////////////////////////////////////////////////////\n\nvar PseudoButton = forwardRef(function (props, ref) {\n  return jsx(PseudoBox, _extends({\n    ref: ref,\n    as: \"button\"\n  }, props));\n});\nPseudoButton.displayName = \"PseudoButton\";\nvar MenuButton = forwardRef(function (_ref2, ref) {\n  var onClick = _ref2.onClick,\n      onKeyDown = _ref2.onKeyDown,\n      _ref2$as = _ref2.as,\n      Comp = _ref2$as === void 0 ? PseudoButton : _ref2$as,\n      rest = _objectWithoutPropertiesLoose(_ref2, [\"onClick\", \"onKeyDown\", \"as\"]);\n\n  var _useMenuContext = useMenuContext(),\n      isOpen = _useMenuContext.isOpen,\n      focusOnLastItem = _useMenuContext.focusOnLastItem,\n      focusOnFirstItem = _useMenuContext.focusOnFirstItem,\n      closeMenu = _useMenuContext.closeMenu,\n      menuId = _useMenuContext.menuId,\n      buttonId = _useMenuContext.buttonId,\n      autoSelect = _useMenuContext.autoSelect,\n      openMenu = _useMenuContext.openMenu,\n      buttonRef = _useMenuContext.buttonRef;\n\n  var menuButtonRef = useForkRef(buttonRef, ref);\n  return jsx(Comp, _extends({\n    \"aria-haspopup\": \"menu\",\n    \"aria-expanded\": isOpen,\n    \"aria-controls\": menuId,\n    id: buttonId,\n    role: \"button\",\n    ref: menuButtonRef,\n    onClick: wrapEvent(onClick, function () {\n      if (isOpen) {\n        closeMenu();\n      } else {\n        if (autoSelect) {\n          focusOnFirstItem();\n        } else {\n          openMenu();\n        }\n      }\n    }),\n    onKeyDown: wrapEvent(onKeyDown, function (event) {\n      if (event.key === \"ArrowDown\") {\n        event.preventDefault();\n        focusOnFirstItem();\n      }\n\n      if (event.key === \"ArrowUp\") {\n        event.preventDefault();\n        focusOnLastItem();\n      }\n    })\n  }, rest));\n});\nMenuButton.displayName = \"MenuButton\"; //////////////////////////////////////////////////////////////////////////////////////////\n\nvar MenuList = function MenuList(_ref3) {\n  var onKeyDown = _ref3.onKeyDown,\n      onBlur = _ref3.onBlur,\n      props = _objectWithoutPropertiesLoose(_ref3, [\"onKeyDown\", \"onBlur\"]);\n\n  var _useMenuContext2 = useMenuContext(),\n      index = _useMenuContext2.activeIndex,\n      isOpen = _useMenuContext2.isOpen,\n      focusAtIndex = _useMenuContext2.focusAtIndex,\n      focusOnFirstItem = _useMenuContext2.focusOnFirstItem,\n      focusOnLastItem = _useMenuContext2.focusOnLastItem,\n      closeMenu = _useMenuContext2.closeMenu,\n      focusableItems = _useMenuContext2.focusableItems,\n      buttonRef = _useMenuContext2.buttonRef,\n      menuId = _useMenuContext2.menuId,\n      buttonId = _useMenuContext2.buttonId,\n      menuRef = _useMenuContext2.menuRef,\n      closeOnBlur = _useMenuContext2.closeOnBlur,\n      placement = _useMenuContext2.placement;\n\n  var handleKeyDown = function handleKeyDown(event) {\n    var count = focusableItems.current.length;\n    var nextIndex;\n\n    if (event.key === \"ArrowDown\") {\n      event.preventDefault();\n      nextIndex = (index + 1) % count;\n      focusAtIndex(nextIndex);\n    } else if (event.key === \"ArrowUp\") {\n      event.preventDefault();\n      nextIndex = (index - 1 + count) % count;\n      focusAtIndex(nextIndex);\n    } else if (event.key === \"Home\") {\n      focusOnFirstItem();\n    } else if (event.key === \"End\") {\n      focusOnLastItem();\n    } else if (event.key === \"Tab\") {\n      event.preventDefault();\n    } else if (event.key === \"Escape\") {\n      closeMenu();\n    } // Set focus based on first character\n\n\n    if (/^[a-z0-9_-]$/i.test(event.key)) {\n      event.stopPropagation();\n      event.preventDefault();\n      var foundNode = focusableItems.current.find(function (item) {\n        return item.textContent.toLowerCase().startsWith(event.key);\n      });\n\n      if (foundNode) {\n        nextIndex = focusableItems.current.indexOf(foundNode);\n        focusAtIndex(nextIndex);\n      }\n    }\n\n    onKeyDown && onKeyDown(event);\n  }; // Close the menu on blur\n\n\n  var handleBlur = function handleBlur(event) {\n    if (closeOnBlur && isOpen && menuRef.current && buttonRef.current && !menuRef.current.contains(event.relatedTarget) && !buttonRef.current.contains(event.relatedTarget)) {\n      closeMenu();\n    }\n\n    onBlur && onBlur(event);\n  };\n\n  var styleProps = useMenuListStyle();\n  return jsx(Popper, _extends({\n    usePortal: false,\n    isOpen: isOpen,\n    anchorEl: buttonRef.current,\n    placement: placement,\n    modifiers: {\n      preventOverflow: {\n        enabled: true,\n        boundariesElement: \"viewport\"\n      }\n    },\n    minW: \"3xs\",\n    rounded: \"md\",\n    role: \"menu\",\n    ref: menuRef,\n    id: menuId,\n    py: 2,\n    \"aria-labelledby\": buttonId,\n    onKeyDown: handleKeyDown,\n    onBlur: handleBlur,\n    tabIndex: -1,\n    zIndex: \"1\",\n    _focus: {\n      outline: 0\n    }\n  }, styleProps, props));\n}; //////////////////////////////////////////////////////////////////////////////////////////\n\n\nvar MenuItem = forwardRef(function (_ref4, ref) {\n  var isDisabled = _ref4.isDisabled,\n      onClick = _ref4.onClick,\n      onMouseLeave = _ref4.onMouseLeave,\n      onMouseEnter = _ref4.onMouseEnter,\n      onKeyDown = _ref4.onKeyDown,\n      _ref4$role = _ref4.role,\n      role = _ref4$role === void 0 ? \"menuitem\" : _ref4$role,\n      props = _objectWithoutPropertiesLoose(_ref4, [\"isDisabled\", \"onClick\", \"onMouseLeave\", \"onMouseEnter\", \"onKeyDown\", \"role\"]);\n\n  var _useMenuContext3 = useMenuContext(),\n      focusableItems = _useMenuContext3.focusableItems,\n      focusAtIndex = _useMenuContext3.focusAtIndex,\n      closeOnSelect = _useMenuContext3.closeOnSelect,\n      closeMenu = _useMenuContext3.closeMenu;\n\n  var styleProps = useMenuItemStyle();\n  return jsx(PseudoBox, _extends({\n    as: \"button\",\n    ref: ref,\n    display: \"flex\",\n    textDecoration: \"none\",\n    color: \"inherit\",\n    minHeight: \"32px\",\n    alignItems: \"center\",\n    textAlign: \"left\",\n    outline: \"none\",\n    px: 4,\n    role: role,\n    tabIndex: -1,\n    disabled: isDisabled,\n    \"aria-disabled\": isDisabled,\n    onClick: wrapEvent(onClick, function (event) {\n      if (isDisabled) {\n        event.stopPropagation();\n        event.preventDefault();\n        return;\n      }\n\n      if (closeOnSelect) {\n        closeMenu();\n      }\n    }),\n    onMouseEnter: wrapEvent(onMouseEnter, function (event) {\n      if (isDisabled) {\n        event.stopPropagation();\n        event.preventDefault();\n        return;\n      }\n\n      if (focusableItems && focusableItems.current.length > 0) {\n        var nextIndex = focusableItems.current.indexOf(event.currentTarget);\n        focusAtIndex(nextIndex);\n      }\n    }),\n    onMouseLeave: wrapEvent(onMouseLeave, function () {\n      focusAtIndex(-1);\n    }),\n    onKeyDown: wrapEvent(onKeyDown, function (event) {\n      if (isDisabled) return;\n\n      if (event.key === \"Enter\" || event.key === \" \") {\n        event.preventDefault();\n\n        if (onClick) {\n          onClick();\n        }\n\n        if (closeOnSelect) {\n          closeMenu();\n        }\n      }\n    })\n  }, styleProps, props));\n});\nMenuItem.displayName = \"MenuItem\"; //////////////////////////////////////////////////////////////////////////////////////////\n\nvar MenuDivider = forwardRef(function (props, ref) {\n  return jsx(Divider, _extends({\n    ref: ref,\n    orientation: \"horizontal\"\n  }, props));\n});\nMenuDivider.displayName = \"MenuDivider\"; //////////////////////////////////////////////////////////////////////////////////////////\n\nvar MenuGroup = forwardRef(function (_ref5, ref) {\n  var children = _ref5.children,\n      title = _ref5.title,\n      rest = _objectWithoutPropertiesLoose(_ref5, [\"children\", \"title\"]);\n\n  return jsx(Box, {\n    ref: ref,\n    role: \"group\"\n  }, title && jsx(Text, _extends({\n    mx: 4,\n    my: 2,\n    fontWeight: \"semibold\",\n    fontSize: \"sm\"\n  }, rest), title), children);\n});\nMenuGroup.displayName = \"MenuGroup\"; //////////////////////////////////////////////////////////////////////////////////////////\n\nexport default Menu;\nexport { MenuButton, MenuDivider, MenuGroup, MenuList, MenuItem };\nexport * from \"./MenuOption\";"]},"metadata":{},"sourceType":"module"}